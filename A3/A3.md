# IFC Thermal Quantifier

## Assignment A3

### About the Tool

The tool automates the validation of thermal performance claims for the building envelope elements (Walls, Windows, Slabs, Roofs) by auditing the geometric and thermal data within the model. The manual process is time-consuming and prone to transcription errors. This tool provides a fast, objective way to check if the as-modeled U-values and areas align with the claimed design values, often derived from national building codes like BR18 or sustainability standards like DGNB.

The IFC Thermal Quantifier directly addresses the validation gap between the design report (e.g., 25-16-D-MEP, Tables 1 & 3) and the BIM model. It ensures data integrity by verifying that the actual model data used for quantities and material definitions matches the required performance specifications.

The tool is a single-file Python script utilizing "ifcopenshell" and "pandas" to process and report on all exterior envelope elements ("IfcWall", "IfcSlab", "IfcRoof", "IfcWindow").

**Key Technical Features Implemented in the Script:**

* **Robust Property Hunting:** Uses the `get_properties_merged` and `find_prop_value` functions to perform a **fuzzy search** across both instance and type property sets for common variations of property names (e.g., "U Value," "ThermalTransmittance," "Thickness").
* **Unit Normalization:** The `clean_numeric` function standardizes unit input, automatically converting common measurements like millimeters ("mm") to meters ("m") and applying a heuristic for large unit-less numbers often entered as millimeters.
* **Window Composite U-Value:** Calculates the final area-weighted U-value for windows using a detailed method:
    1.  It attempts to extract frame and glass material properties (conductivity, thickness).
    2.  If material data is missing, it falls back to pre-defined defaults (e.g., "FRAME_K: 0.17", "GLASS_U: 1.2").
    3.  It calculates the area of the glass and frame based on `OverallWidth`, `OverallHeight`, and `FrameWidth`. If dimensions are missing, it uses a 15% Frame / 85% Glass area ratio fallback.
* **Geometric Area Fallback:** For elements like `IfcSlab` and `IfcRoof`, the `calculate_geom_area` function uses `ifcopenshell.geom` to tessellate the object and calculate the upward-facing surface area (by checking the Z-component of the face normal vector), providing an area when no explicit property exists.
* **Comprehensive Reporting:** Generates a multi-sheet Excel file that includes:
    * A **MASTER SUMMARY** (Area-Weighted Average U-Value per category/position).
    * Detailed Type Summaries.
    * Raw Data tables for all extracted elements.

#### Instructions to run the tool.
1.  **Install Dependencies:** Run the following command in your terminal:
    ```bash
    pip install ifcopenshell pandas numpy openpyxl
    ```
2.  **Setup Files:** Place your single Python script (e.g., `thermal_quantifier.py`) and the target IFC model (e.g., `25-16-D-ARCH.ifc`) in the same local folder.
3.  **Execution:** Run the script using a Python interpreter:
    ```bash
    python thermal_quantifier.py
    ```
4.  **Output:** A thermal report Excel file (e.g., "25-16-D-ARCH_THERMAL_REPORT.xlsx") will be generated on your Desktop.

### Advanced Building Design

#### What Advanced Building Design Stage (A, B, C or D) would your tool be useful?
The tool is most useful in Stage D: Technical Design.

At this stage, the BIM model contains fully specified building elements, including material layers, precise dimensions, and detailed property sets. This is the optimal time to use the tool to run a final, detailed quality assurance check before the model is issued for construction documentation, ensuring compliance with the thermal performance goals.

#### Which subjects might use it?
* **Building Services Engineers (MEP/Energy Modeler):** To perform a quick, objective audit of the U-values and areas provided in the architectural model before using them as input for energy simulation software.
* **BIM Managers/Coordinators:** To implement a standard **Model Quality Control (QC) Gate**, specifically checking for the presence, format, and consistency of critical thermal properties across all envelope elements.
* **Cost Consultants/Quantity Surveyors:** To verify the total area of the external envelope (Walls, Roofs) for cost estimation of insulation and cladding materials.

#### What information is required in the model for your tool to work?
The tool is resilient due to its fallbacks, but optimal performance requires:

1.  **IFC Entities:** Correct classification of elements as `IfcWall`, `IfcSlab`, `IfcRoof`, and `IfcWindow`.
2.  **Thermal Property Data (Priority 1):** Explicit, instance- or type-based property for the overall U-value (e.g., `Pset_ThermalTransmittance` with property `ThermalTransmittance` or a user-defined property like `U Value`).
3.  **Geometric Data (Priority 2):** Explicit dimensional properties (Area, Thickness) or reliable geometry definitions for area fallback calculations.
4.  **Window Specifics:** For maximum accuracy, the model should include **frame-specific properties** (e.g., `FrameWidth`, and material properties linking to conductivity/thickness for frame and glass).

### Information Delivery Specification (IDS)

XXX - Excel output?

### BPMN diagram
![BPMN diagram](../A1+A2/Use_case_diagram.svg)













